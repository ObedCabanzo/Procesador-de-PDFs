© The British Computer Society 2019. All rights reserved.
For permissions, please e-mail: journals.permissions@oup.com
Advance Access publication on 14 November 2019
doi: 10/comjnl/bxz109
# New Security Risk Value Estimate Method for Android Applications
Latifa Er-rajy*, My Ahmed El Kiram and Mohamed El Ghazouani
Department of Computer Sciences, University Cadi Ayyad, Marrakesh, Morocco
∗Corresponding author: errajy.latifa@gmail.com
Downloaded from https://academic.oup.com/comjnl/article/63/4/593/5618854 by Pontificia Universidad Javeriana user on 12 August 2024
Nowadays, mobile applications are the devices’ core, so their security is essential for the platform on which are installed. Therefore, to make this security strong, Android implements permission system and sandboxing mechanism to reduce the attacks contingency. Also, antivirus software is used to detect the already known malware based on their signature, but unfortunately, this kind of program cannot detect cloned or repackaged malware. Thus, using authorizations to estimate the security vulnerability will surely be very useful for avoiding applications that are more susceptible to be dangerous according to the risk values obtained. Consequently, this will provide systematic support that will make it easier for users to make appropriate decisions and therefore greatly improve the Android devices’ security. In this article, additionally to the risk measures that have been already proposed in previous studies based on functionalities such as permissions and function calls, we add a set of mathematical metrics describing the case of susceptible and innocent applications already known. Our risk assessment exploits applications already known as malware and safe samples without any threat.
Keywords: components; risk; permissions; Android; method
Received 22 September 2018; Revised 25 June 2019; Editorial Decision 14 August 2019
Handling editor: Mark Ryan
# 1. INTRODUCTION
In Android system, the majority of functionalities and features can be installed by end users as applications (apps) developed by anonymous developers or downloaded from PlayStore and Android markets. These apps provide access to the different types of services available on the device and access to end-user sensitive, private and personal data, such as contact lists, geo-location, messages and social networks . These types of accessibility make the privacy and security assurance more difficult. So, to combat the attacks that target Android, the permissions and sandboxing mechanisms are applied . This means that if an application has intention to perform any malicious activities such as making phone calls, stealing user-sensitive data or simply sending premium messages, the attacker must deceive users in order to install a malicious application, because other previously existing intrusion ways are almost eliminated in Android recent versions . At the installation time, an application must request permission to access system resources (such as location, Internet, cellular networks, etc.), and the user either accepts all the requested permissions or cancels the installation, since it is not possible to accept or deny access privileges selectively . The permissions granted to the application are not changeable as they are revoked from it when the user starts its removal process. Even if this security mechanism seems to be very simple and easy, but it creates many challenges because many users simply accept these authorizations without considering their implications on their personal data  since they do not usually have much time to study and think about the side effects of these permissions, they are only interested in completing the application installing process quickly to use it.
On the other hand, technical skills of an ordinary user are not enough to understand well the requested permissions impacts . In addition, an innocent application and a malware may request similar permissions, which will obviously complicate the task of making the correct decision by the end users. For example, if an application has granted certain critical permissions such as Internet permission, this application can easily control communication with remote servers. And, if it has access to the camera as well, it can send user personal pictures to any server on the Internet. For all these reasons, the security offered by the Android model is weak and vulnerable. It is unable to preserve the personal information from disclosure or to prevent fraudulent use of monetary resources. In fact,
Section D: Security in Computer Systems and Networks The Computer Journal, Vol. 63 No. 4, 2020
spyware, Trojan horses or adware can easily induce users by pretending to be a useful application for him and then hack banking applications on his device to steal his credit . To ensure an effective security, we propose in this article a new method to calculate the risk score that an application may cause to the user safety and send him a warning if the risk value obtained exceeds a predetermined value. This will allow the user to compare similar applications based on their risk scores. Android markets are in urgent need of an effective measure to calculate the risk rate that applications can present, in order to be able to identify and detect those that seem to be suspicious among the large number of applications newly submitted by developers. However, it will take a lot of time to carry out a detailed and thorough analysis for each new application in aiming to detect malware. Indeed, our studies [8–11] based on detailed evaluations reveal that Android risk calculation models use measures with vulnerabilities and unacceptable performances, which will undoubtedly force end users to lose confidence in Android applications. In fact, Android system never calculates high-risk values for an unknown malicious application. Actually, it has a low level of risk for this kind of application.
In this article, we present a new measurement that calculates the risk rate of Android applications much higher than those already proposed by other researchers. In fact, the existing risk measures are weak because they are mainly based on a single criterion. Nevertheless, our solution is based on a large set of well-known malicious applications. We proved our proposition effectiveness by performing many in-depth experiments on many actual applications samples selected from Android markets.
This article organization is as follows: In Section II, we present our related work. In Section III, we discuss Android security issue behind our solution. We present our proposed measure for calculating the risk rate in Section IV. Then, in Section V, we present the results obtained after our measure experimental evaluations applied to normal and malicious Android applications and their comparisons with those previously obtained by measures already proposed. Finally, in Section VI, we conclude our article.
# 2. RELATED WORK
If we look at Android system security, we find that there is a small number of researches that is interested in this topic. As we explained before, Android users have only two choices in front of them, whether they accept the permissions requested by the application they want to install to start its installation or deny the requested permissions and completely cancel the application installation process. The results obtained by these researches show that most users accept these permissions without paying attention to their impact on their personal data, which can be very dangerous if they fall in the hacker’s hands. Of course, researchers have tried to find effective solutions to solve this problem. So, they come out by some propositions to improve the already existing Android security architecture [12–14]. For example, Chin et al.  proposed to change Android permissions categorizations by highlighting the security danger instead of focusing on the requested permissions. They therefore proposed a new method to accept the permissions required by the application to be installed.
Correspondingly, Kelley et al.  proposed to control access to high-level critical data that affects the user’s privacy. Consequently, they proposed to replace the permission names with location information and contact lists in the first install page. Gates et al.  as well advised adapting the risk rate visualization to reduce the memory space size required for displaying permissions to the user and help him to make quick, correct and efficient decisions about the applications he wants to install on his device. In order to calculate these scores, Gates et al.  had based on varying set of permissions requested by each Android application. The majority of users prefer to have a brief summary of threat results or security display as graphical indicators since they are more convenient than textual information.
Similarly, Peng et al.  proposed using crawl models and statistical metrics to compute security risk scores basing on permissions requested by Android apps. The approach they proposed is to rank apps in a market similar to PlayStore based on their risk rate, which has encouraged users to select safer app among applications available with the same functionality with different levels of danger. Afterward, Gates et al.  had improved their previous solution by accurately describing many statistical scores risks using Android permissions to generate probabilities for Android apps. They also exploited all measurements obtained based on critical permissions, such as those allowing access to sensitive software and hardware resources and usually used by malware. Generally, Android malicious applications request critical permissions to exploit the API functions to perform malicious activity against the user. Correspondingly, Gates et al.  used the permissions requested by benign applications to calculate risk scores. However, both solutions have increased the facts of some critical permissions that influence the obtained risk rate values to improve their proposition performance. Indeed, Gates et al. manually selected a set of critical permission consisting of nine permissions that can be used by malware to perform dangerous actions. Similarly, Sarma et al.  proposed to use critical permissions requested by Android applications, but unlike Gates et al. , they choose to rely on the permissions that are rarely required by normal applications for the purpose of recognizing dangerous applications. As well, Grace et al.  implemented an automated system they called “RiskRanker” to check if an application has dangerous behavior or not. To develop this system, they exploited the malicious behaviors commonly used in malware belonging to the same time interval. RiskRanker was used as an initial step before putting the application on
# Security Risk Value Estimate Method
the official Android market “PlayStore”’; RiskRanker has the ability to detect malware by producing a list to classify the suspicious application priority based on their risk value gotten. Besides, Enck et al.  implemented a Java static analysis tool with an aim to decompile applications; due to this tool, they were able to evaluate a large set of applications and study their API usage. However, they only focused on studying applications that use an API call with an unimportant number of permissions. In another study, Felt et al.  manually sort a small collection of Android applications to check whether they are overprivileged or not. But, unfortunately, they were unable to separate between necessary and unnecessary permissions because of the limited documentation provided by Android. Moreover, Barrera et al.  collected 1100 free Android applications and analysed the requested permissions. They primarily focused on the permission system structure, and then they grouped applications together using a neural network and searched for patterns in these permissions. They noted that 62% of applications collected in December 2009 use the Internet permission.
Sharma and Gupta presented in  a novel approach they called RNPDroid for risk mitigation using the permissions analysis. Also, The article written by Razak et al.  has highlighted the significant findings of risk assessment and the risk zone for Android applications through their tool called EZADroid, which implements a permission-based application to determine the risk zone. In addition, Hammad et al.  have developed DelDroid, an automated system for determination of least privilege architecture in Android and its enforcement at runtime. A key contribution of DelDroid is the ability to limit the privileges granted to apps without modifying them. This tool utilizes static analysis techniques to extract the exact privileges each component needs.
Our proposed measure basically relied on Enck’s and Arp’s works. Enck et al.  introduced Kirin, a tool that relies on security rules to simultaneously prevent the installation of malware and allow legitimate app. These rules are developed by adapting requirements engineering techniques to mitigate malware from an analysis of applications, phone stakeholders and system interfaces. So, when a user wants to install an application, the Kirin-based software installer extracts the security configuration from the manifest file. Then, the Kirin security service evaluates this configuration. If it fails to pass all predefined security rules, the installer has two choices. The safest choice is to reject the request. The other choice is to use a user interface to replace the analysis results.
The risk rate identification of dangerous applications with Kirin included five steps:
1. Identification of the assets: in this step, Kirin extracts requested features. For example, if an application requests the permission RECORD_AUDIO, then the asset here is the microphone input.
2. Identification of functional requirements.
3. Determination of goals and threats for security.
4. Definition of security requirements of the asset.
5. Determination of the limits of the security mechanism.
Kirin studies in all those steps the permissions requested by an application in order to determine its nature. We also use the requested permissions in our proposed measure to attribute a risk value to an application. In addition to this criterion, we use other indicators such as API calls, intents, function calls, etc.; similar to Enck et al., we based on malware samples and similarity remoteness in our proposition.
Arp et al.  introduced a lightweight measure they called DREBIN, which can detect and identify malware directly on the device of the Android user. To extract the features of an application such as permissions, API calls and network addresses, DREBIN performs a broad static analysis. Then these features are integrated into a common vector space. The purpose of this geometric representation is to automatically identify combinations and characteristics indicative of malicious applications by exploiting machine learning techniques. DREBIN provides the user with an explanation for each detected application, as well as an overview of the samples of malicious applications already identified.
DREBIN is based on a complete and light representation of applications to determine the indications that characterize a malicious activity according to the following process:
1. Wide static analysis: In this step, DREBIN extracts the set of features included in manifest and dex files of the application.
2. Integration in a vector space: In this second step, DREBIN takes the extracted feature sets and integrates them into a common vector space to geometrically analyse the patterns and the combinations of features related to malicious activities.
3. Detection based on learning techniques: In this step, the learning techniques such as linear support vector machines embedding are exploited in the identification of malicious applications.
4. Explanation: In this last step, DREBIN provides the user with an explanation about the detected application and the list of functionalities responsible for this detection.
In brief, in our proposed measure, we relied on the similarity remoteness proposed by Enck et al. and on the idea of Arp et al. to use extract features from an application and compare them to those that belong to malicious activities, in order to attribute a risk value to unknown applications. Besides the static analysis used by Arp et al., we use a dynamic analysis in our measure to detect the application behavior.
# 3. ISSUE DESCRIPTION
Indicators such as Android permissions, function calls and exploit static and dynamic behaviors can be used in the risk
Section D: Security in Computer Systems and Networks The Computer Journal, Vol. 63 No. 4, 2020
E. Latifa et al.
This will provide the highest relative risk value for an unsecured application, as well as the potential for this malicious application. So, when the user wants to install or just use an application that seems to be suspicious, our proposed security measure employs warning signals to invert the user. In fact, this measure makes it possible to establish the application priorities based on the security risks value found. Therefore, our main goal of this work is to provide a reliable and effective security measure to protect Android users by assigning high-risk rates to malicious apps to easily distinguish them. So, finding a high detection rate for malicious applications from a set of unknown applications is strongly needed to ensure the effectiveness of a risk measure.
# 4. OUR PROPOSITION
Our proposed measure RVC is involved once a user wants to install a new application on his device; our system extracted the various features contained in its APK file in the preprocessing phase. The main concept behind our solution is quite simple, but it guarantees a very interesting results production. Our measure relies on a database that contains a set of Android application representation with their extracted features and their final risk rate. Based on that information, we can get a more accurate representation and a better risk estimate. In our own view, the security risk is directly related to its remoteness from malicious applications when it comes to an unreliable application. Thus, there is a high probability that an application is likely to be malicious, when it is close to all malicious applications samples, because this means that it has the same behavior.
There are two types of features extracted from an application:
- Static: This type of functionality includes permissions, intent filters, Java code, network address and hardware components.
- Dynamic: This type is about how an application will behave if it is installed on the user’s devices.
Applications analysis goes into three main steps: preprocessing or extracting the application data, estimating the risk by using the extracted feature and obtaining final risk values. Preprocessing is exploited to extract the application characteristics such as permissions, API function calls, intentions, material resources etc, since these characteristics can have a varied importance on the obtained risk value. To obtain a precise and effective security risk rate, it is necessary to use malicious application samples for calculating higher values.
In the case of an unknown application, it is very likely to be safe, if the remoteness to the normal application center is less than the remoteness to the center of the malicious applications. Then, by applying this condition, we used the following formula:
Section D: Security in Computer Systems and Networks The Computer Journal, Vol. 63 No. 4, 2020
# Security Risk Value Estimate Method
Each malicious application instance in our set is represented by a set of features common between malicious and normal applications. This is noted as f = { f1, f2, . . . , fn}, and m = {m1, m2, . . . , mn} denotes the malicious application available sets exploited in the risk rate estimate.
For each feature, the average value of malicious applications is noted by Sm (fi), Sn (fi) representing the average value of normal applications set. The two values are computed based on the two following equations:
Sm
∀ fi ∈ F Sm(fi) = ∑Sm fij (1)
∀ fi ∈ F Sn(fi) = ∑Sn Sn fi (2)
Sm and Sn in the equations above represent, respectively, the size of malicious and normal applications we have; the feature description in the malicious application and in the normal applications is noted with fij and f, respectively. According to these formulations, we can calculate the malicious applications averages by exploiting the remoteness methods to obtain the risk rates. In other words, as shown in Figure 2, the centers are calculated for points reflection of normal and malicious applications samples. Then, we calculate the risk rate of an unknown application x by using the following equation:
RVC (x) = √∑|F|2 / √∑|F|(Xsm − fjx)2 (3) / ∑|F|(Xsn − fix)2
RVC (x) in this formulation represents the risk rate calculated based on the instance of an unknown application x. Indeed, by exploiting the equation above, we compute in an isolated way the average points by applying Formulations (1) and (2) for all available malicious applications.
In addition, we get all the application x remoteness and the average of all its entities. The Formulation (3) is used to calculate the estimated risk value for the considered application x. This equation constituted of the two average points obtained for all the types of available applications. The risk value estimate for application x is gotten by comparing the malicious applications average behavior available in our samples with the application x remoteness and inversely related to the normal applications average behavior compared to the application remoteness. The data measured in this remoteness are adequate on the same scale. The pseudo-code of the main steps for calculating parameters and measuring the risk rate for a given application list Lx is illustrated by Algorithm 1. This list can contain one application when a user wants to install an application or all the already installed applications on his device.
The symbols used in Algorithm 1 are represented in Table 1. The Algorithm 1 is used to calculate the average value of the normal and malicious applications by applying Formulations (1) and (2), which provide all the available features, the malicious applications set Sm and the normal applications set Sn represent the Algorithm 1 inputs. This algorithm execution helps us to get the average of all applications.
Lines 3 to 11 calculate the average value for all features separately. The normal applications average behavior is measured by lines 3 to 6 and for malicious applications by lines 7 to 10. Line 14 returns these values. The risk value RVC is calculated for each application x belonging to Lx by executing lines 15 to 21 and obtained by the line 24.
The security and privacy of the end user can be seriously damaged by the various malicious applications existing in the Android market, such as some Trojans that exploit the device monetary resources to send SMS or make advertising calls.
# Section D: Security in Computer Systems and Networks
The Computer Journal, Vol. 63 No. 4, 2020
# Algorithm RVCcompter (F, Sn; Sm; Lx; XsnxXsa)
In addition, there are many malicious applications that aim to disclose and steal the user personal information without his permission or to install new malicious applications in the background without his knowledge. This example shows that all malicious applications have different risk values depending on their malicious actions. The method proposed by our system allows us to take into consideration the available malware samples behaviors to obtain a more accurate risk estimate. The most dangerous samples may be subject to additional criteria when the average value is obtained for malicious applications. Furthermore, features with different risk values such as the ones that require permissions, like SEND_SMS, INSTALL_PACKAGES and DELETE_PACKAGES, are saved in the list of the most dangerous applications [24–26]. In another example, there are malicious applications that have certain monetary calls information allowing them to access private resources and personal information from the device owner. Twenty-six permissions have been identified as critical permissions by Sarma et al. . Besides, Yuan et al.  improved malicious applications detection using 64 API calls, and they exploited 18 dynamic behaviors. By applying these results, we can also guarantee a better risk estimate and adding an additional entity criterion to our proposed model. However, without applying this improvement, the empirical evaluation results of our system show that applied measures provide very good risk values and a very efficient malware detection rate.
# ALGORITHM 1. RVC calculation.
shows an example of the most five important features extracted from three malicious applications from our predefined dataset. Starting from Android version 6, users are not obliged to accept the permissions requested by an application to install it, so they can now grant permissions when running it. Android 6 also provides users with advanced features and control of their applications by allowing them to select the permission granted to an application through a configuration interface . For example, a user may refuse to give an application permission to view his contact list or read his SMS and at the same time allows it to access to the location of his device. For this case, in the implementation of our tool named PerUpSecure, our method RVC measures the risk rate of the applications installed on the user’s device as shown in Figure 3. Also, our tool helps the user to know if the application really needs the requested permissions or not.
# 5. EXPERIMENTAL EVALUATION
For our experimental evaluation, we used the tools Eclipse and MATLAB to provide the necessary codes to implement and evaluate the measures proposed by our system. These tools allowed us to get the risk score by evaluating and comparing two sets of malicious and normal applications.
# Section D: Security in Computer Systems and Networks
The Computer Journal, Vol. 63 No. 4, 2020
# Security Risk Value Estimate Method
Downloaded from https://academic.oup.com/comjnl/article/63/4/593/5618854 by Pontificia Universidad Javeriana user on 12 August 2024
We first dealt with all the malicious applications collected on the web by Gates et al. . In addition, we evaluated all the existing applications on the Arp et al.  official website. Their applications set was a mix of malicious applications and innocent applications from different sources. We have exploited these applications to evaluate and compare our proposed approach with those proposed previously.
Therefore, to obtain a precise and effective risk rate and thus guarantee a better detection rate, it is necessary to obtain lower values for normal applications. Indeed, we applied a detection rate evaluation to our measure RVC, and then we compared it.
# Section D: Security in Computer Systems and Networks
The Computer Journal, Vol. 63 No. 4, 2020
# Section D: Security in Computer Systems and Networks
# The Computer Journal, Vol. 63 No. 4, 2020
600 E. Latifa et al.
The area below the curve for an alert rate up to 190
with that previously proposed by the approaches illustrated in Table 3.
So, it is obvious that the detection rate is higher with the existence of a very large number of malicious applications placed at the top of the sorted list. So, if we get for example very low warning rate (1% or 5%), it means that our measurement is very strong concerning the calculation of the risk score. Indeed, our detection rate is very high because a large number of malwares exist in the smallest applications set with the highest risk rate. In other words, there is a high probability that the malicious applications have the highest risk score, but they may be normal in some cases. Previous studies  have used the same experimental framework.
This evaluation is used to make a comparison between malicious applications and normal applications in order to test the execution speed of the risk calculation measures and the high-risk value assignment to these applications.
Downloaded from https://academic.oup.com/comjnl/article/63/4/593/5618854 by Pontificia Universidad Javeriana user on 12 August 2024
# Security Risk Value Estimate Method
The main problem we encountered at the experiment time was to assign higher risk values to the malicious applications with the aim to calculate the detection rate. In our first evaluation, we measured the detection rates based on a warning rate interval between 0 and 1. Figure 5 represents Receiver Operating Characteristic (ROC) curves obtained for all the measures results including ours. Warning rate is presented by the horizontal axis, and the vertical axis shows the detection rate. As shown in the figure, our results are clearly superior to other approaches, especially that the warning rates we obtained are the lowest. Generally, all measurements converge to the full detection rate as the warning rate increases and performance remoteness decreases. However, when the false-positive number is lower, it is more desirable for the user that the warning rate is lower.
Thus, our RVC curve is very close to the one that represents the effectiveness of all the proposed risk score measures. This proves that the RVC assigns higher risk values to malicious applications compared to nonmalicious applications since RVC exploits full information gotten from previous normal and malicious instances. Also, RVC has higher generalization properties because it also uses the average behavior of these applications, which drives all unknown malicious applications to higher levels of detection rate. To better illustrate this experiment, for all the studied methods, the X axis of Figure 6 illustrates the curves obtained for the different warning rate.
We measure the area under our curve with examples of common warning rate values, such as warning rates of (1%, 10% and 20%) or otherwise noted as 0, 0 and 0 since the majority of Android users should be interested in calculating risk rates. Indeed, we calculated in the first zone the curves for the interval between 0 and 0. Figure 6 illustrates all the ROC curves and the results obtained; this figure proves that the detection rate of our measurement is the best for all warning rate values, which means that our proposition in comparison with others gives in the all cases better results.
Our proposition exploits examples of previous malicious applications, while other risk scores are based primarily on the use patterns of permissions requested by malicious applications.
Section D: Security in Computer Systems and Networks The Computer Journal, Vol. 63 No. 4, 2020
applications. Also, detailed statistics of permissions and functions in malware and normal applications should be considered systematically in order to assign lower risk scores for normal applications and higher risk values for malicious applications. On the other hand, our RVC is characterized by a complete and comprehensive representation of malicious applications and normal applications that allow it to more accurately and efficiently estimate the risk rates of unknown applications. However, to improve the proposed RVC performance, we used a test evaluation between the detection rates obtained by our method and the others. In fact, for the 95% confidence interval, the test result obtained shows the existence of a real offset negligible in the detection rates averages compared to the real values.
Downloaded from https://academic.oup.com/comjnl/article/63/4/593/5618854 by Pontificia Universidad Javeriana user on 12 August 2024
# WARIG RAT
during installation or take into consideration only the statistics impact on malicious applications. For example, the closest to our proposed RVC curve is SRS proposed by Enck et al. , its detection rate based only on the permissions scarcity in normal applications. These applications were augmented by using scale factors to improve the impact of certain critical permissions that were manually selected. On the other hand, the information extracted from all normal and malware applications is routinely processed by our proposed RVC to obtain a more realistic risk estimate.
In the second experiment, we evaluated the RVC performance obtained for the Arp et al. set and compared it with the SRS risk score for the same set. We based on the assessments made by Arp et al.  to perform this test and to select permissions and API calls that directly influence the identification and detection of all of malicious Android applications families. We choose SRS for comparison because its performance is the closest to our proposed method. In this comparison, we used the same setting from the first experiment.
So, it is possible that a permission or function is rarely used or reflects similar scarcity values in normal or malicious
# 6. CONCLUSION
In this article, we propose a new method for classifying and filtering Android apps based on their risk rate we called RVC. To evaluate our proposition effectiveness and performance, we performed a set of assessments on the actual Android applications. The results obtained show that our method is capable of getting relatively high-risk rates for unknown malicious applications as compared to normal or ordinary applications. Indeed, our RVC has a higher detection rate if we compare it with other risk methods. Likewise, our method proposed in this article distinguishes itself with its simplicity, because it is enough to calculate the remoteness between the previous applications (normal and malicious) and an unknown application to estimate its risk rate. In this article, we have classified in the same category all the malicious applications analysed. Moreover, we used a database that contains the malicious applications that have become famous for being the most important and ranked dangerous applications, which allowed us to obtain more precise risk values.
# Security Risk Value Estimate Method
603
# Section D: Security in Computer Systems and Networks
The Computer Journal, Vol. 63 No. 4, 2020