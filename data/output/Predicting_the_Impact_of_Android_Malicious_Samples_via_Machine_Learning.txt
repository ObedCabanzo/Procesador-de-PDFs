# PREDICTING THE IMPACT OF ANDROID MALICIOUS SAMPLES VIA MACHINE LEARNING
JUNYANG QIU 1, WEI LUO 1, LEI PAN 1, (Member, IEEE), YONGHANG TAI 2, JUN ZHANG 3, (Senior Member, IEEE), AND YANG XIANG 3, (Senior Member, IEEE)
1 School of Information Technology, Deakin University, Geelong, VIC 3216, Australia
2 School of Physics and Electronic Information, Yunnan Normal University, Kunming 650500, China
3 School of Software and Electrical Engineering, Swinburne University of Technology, Melbourne, VIC 3122, Australia
Corresponding author: Yonghang Tai (taiyonghang@ynnu.edu.cn)
ABSTRACT Recently, Android malicious samples threaten billions of mobile end users’ security or privacy. The community researchers have designed many methods to automatically and accurately identify Android malware samples. However, the rapid increase of Android malicious samples outpowers the capabilities of traditional Android malware detectors and classifiers with respect to the cyber security risk management needs. It is important to identify the small proportion of Android malicious samples that may produce high cyber-security or privacy impact. In this paper, we propose a light-weight solution to automatically identify the Android malicious samples with high security and privacy impact. We manually check a number of Android malware families and corresponding security incidents and define two impact metrics for Android malicious samples. Our investigation results in a new Android malware dataset with impact ground truth (low impact or high impact). This new dataset is employed to empirically investigate the intrinsic characteristics of low-impact as well as high-impact malicious samples. To characterize and capture Android malicious samples’ pattern, reverse engineering is performed to extract semantic features to represent malicious samples. The leveraged features are parsed from both the AndroidManifest.xml files as well as the disassembled binary classes.dex codes. Then, the extracted features are embedded into numerical vectors. Furthermore, we train highly accurate support vector machine and deep neural network classifiers to categorize the candidate Android malicious samples into low impact or high impact. The empirical results validate the effectiveness of our designed light-weight solution. This method can be further utilized for identifying those high-impact Android malicious samples in the wild.
INDEX TERMS Android malware, deep neural network, high impact malicious samples, low impact malicious samples, static analysis, SVM.
# I. INTRODUCTION
Lately Android OS is the number one system globally, with approximately 86% of the whole global mobile phones market share in the Q1 of 2017 . Meanwhile, the prevalence of Android operating system, combining with its openness trait, has caused the number of Android malware skyrocketed in both the official markets (e.g., Google Play1) and third-party (WanDouJia2) Android application markets. In the first quarter of 2017 alone, over 750,000 new Android malware samples were identified by experts in G DATA security .
The associate editor coordinating the review of this manuscript and approving it for publication was Khalid Aamir.
1 https://play.google.com/store
2 https://www.wandoujia.com/
2169-3536 2019 IEEE. Translations and content mining are permitted for academic research only. Personal use is also permitted, but republication/redistribution requires IEEE permission. VOLUME 7, 2019 See http://www.ieee.org/publications_standards/publications/rights/index.html for more information.
# EEE Access
# J. Qiu et al.: Predicting the Impact of Android Malicious Samples via Machine Learning
analysis which is performed during the run-time of the appli- cations. Hybrid analysis will perform both static analysis and dynamic analysis for the candidate applications. The major- ity of the existing works focused on determining whether the candidate Android applications are benign or malicious. However, along with the tremendous number of Android malware being detected every day, only a small fraction of them will incur serious damage to mobile users or organi- zations. Based on this observation, we infer the importance of predicting the impact of malware (low impact or high impact). If the malware is with high impact, we must defend it with high priority to be aware of its potential damage as much as possible. In this paper, we propose a new research problem: How to automatically predict the impact of the detected Android mawlare?
However, there are few work on predicting the impact of the detected Android malware so far. Most of the existing works concerned only the identification of Android mal- ware or classification of malware into the specific families. To investigate the solution to the proposed research ques- tion, we should address three critical challenges. Firstly we need to define the impact metrics to validate the impact of malicious Android samples. Besides, another challenge is the lack of an Android malware dataset with impact ground truth in terms of impact. The third challenge is about how to effectively and efficiently make the impact prediction for the newly encountered Android malware. To address the listed challenges, we make four main contributions in this work:
1. We raise a new research problem: how to automatically and accurately make the impact predict for the identi- fied Android malicious samples?
2. We define two impact metrics (the size of affected Android end devices, in short for SOD, and the size of infected countries, also called SOC) to characterize the impact of Android malicious samples.
3. We construct a new Android malware dataset (also called Mal_Impact Dataset) containing low impact and high impact malicious samples. To facilitate the fol- lowing similar works related to the impact prediction of Android malicious samples, we will release our constructed malware impact dataset to the public.
4. We design a light-weight solution to automatically and accurately make the impact prediction for the identi- fied Android malicious samples. Semantic features are decoded from AndroidManifest.xml files and disassem- bled binary classes.dex codes to represent the intrinsic characteristics of both low and high impact Android malicious samples. Then we train the Support Vector Machine and Deep Neural Network models to cate- gorize the candidate Android malicious samples into low or high impact. Our empirical studies validate the effectiveness and feasibility of our designed solution.
The rest of the paper is organized as follows: Section 2 reviews the related work of Android malware analysis. Our designed methodology is introduced in Section 3. In Section 4, we give the experimental settings, evaluation metrics and detailed results. In Section 5, we present the limitations of this work. Section 6 concludes the paper and gives the following research directions.
# II. RELATED WORK
The analysis and identification of Android malware has been an active research area in the recent years. The research communities have proposed many techniques to deal with the growing number and evolution of Android malware. Android malware detection is surveyed in .
# A. STATIC ANALYSIS TECHNIQUES
Static analysis is conducted through reverse engineering the binary codes of the candidate Android applications with- out actual execution. We can further divided static analysis into three categories: The first category is called signature related methods. These methods focus on producing a robust malware signature based on the particular strings or seman- tic code patterns in the applications’ code packages . Then in the malware detection process, if the candidate application’s signature is similar to one of the signatures in the malware’s signature database, then it is regarded as a malware. DroidAnalytics , AndroSimilar  and ASTROID  are three signature related examples. The sec- ond category is permission related methods which collect the requested permissions declared in AndroidManifest.xml files to detect potential malware. The permission related methods include ,  and . The final category is related to binary Dalvik bytecode classes.dex analysis. This category of methods will obtain the source code through disassembling the binary classes.dex bytecode, such as , , , . When the binary classes.dex codes have been disassem- bled into the corresponding source codes, the suspicious API calls, CFG (control flow graphs), or FCG (function call graphs) can be revealed to represent the discriminate patterns between malicious Android samples and benign samples , , .
# B. DYNAMIC ANALYSIS TECHNIQUES
Dynamic analysis traces and analyses the malicious behav- iors and system calls of Android applications during exe- cution in the virtual environments. TaintDroid  was the pioneer dynamic analysis system. It was efficient in dynamic taint tracking. Another popular dynamic analysis system was DroidScope. DroidScope can rebuild semantic information seamlessly and simultaneously on the Java Dalvik level as well as Linux OS level . Zhang et al.  created a system called VetDroid, which can rebuild malicious and sensitive behaviors in Android applications. Another dynamic frame- work AppsPlayground was implemented to analyze Android applications automatically. AppsPlayground combined many automatic exploration and detection strategies (e.g., kernel level system call monitoring, taint tracing tool ) for large- scale Android applications analysis . An alternative dynamic solution was proposed by Georgios Portokalidis et al. to perform the detection task on remote
VOLUME 7, 2019 66305
# J. Qiu et al.: Predicting the Impact of Android Malicious Samples via Machine Learning
security servers in the cloud where execution of the appli- cations on the device is mirrored in virtual machine envi- ronments. The remote servers are not subject to the same constraints with the devices, thus it is possible to employ multiple detection techniques in parallel .
# C. MACHINE LEARNING BASED TECHNIQUES
As we know, machine learning technique has been used in many cyber security related areas , , , , , . In the malware analysis area, it is expensive and difficult for security experts to manually generating and updating the malware detection patterns (or signatures) for Android malware. Inspired by the efficiency and generaliza- tion ability of machine learning technique, many machine learning involved methods have been designed to automat- ically detect or further classify Android malware samples. Drebin is a traditional and notable machine learning method which can detect Android malicious samples directly on the mobile devices . Drebin employed semantic features parsed from both AndroidManifest.xml files and disassem- bled binary classes.dex files. In addition, the papers , , , , , and  all used machine learning related methods. In summary, the key challenge of machine learning related methods is how to obtain the robust and informative features to represent Android malware samples. The seman- tic features may be directly derived from statistical features (for example, API calls, requested or used permissions ), features of a tree structure (for example, abstract syntax tree) or features of a graph structure (for example, API call graphs (ACG) , data flow graphs (DFG) or control flow graphs (CFG)).
# III. METHODOLOGY
In this part, we give the detailed introduction of our proposed framework in Fig. 1.
# A. OVERVIEW
The proposed framework consists of three phases. Firstly, the training Android malware samples will be collected with low impact or high impact ground truth. Secondly, based on the collected malware applications, reverse engineering will be conducted to extract features from the disassem- bled binary classes.dex codes and from AndroidManifest.xml. These extracted semantic features will be employed to rep- resent the impact characteristics of each Android malware sample. Then the extracted string features will be encoded into numerical vector representations. Finally, with the vec- tor representations, we train the impact prediction model to categorize the candidate Android malware samples into low impact or high impact. The details of each step will be presented in the following sections.
66306
VOLUME 7, 2019
# J. Qiu et al.: Predicting the Impact of Android Malicious Samples via Machine Learning
# B. DATA COLLECTION
The critical challenge of the proposed research problem origins from the absence of an Android malware dataset with impact ground truth available. Thus, to further validate our proposed solution to the research problem, we have to construct a dataset with high impact or low impact ground truth. Fig. 2 presents the steps of how to construct the Android malware dataset together with impact ground truth (called Mal_Impact Dataset, denoted as D).
In this work, the constructed Mal_Impact Dataset is built on three open sourced Android malware datasets with family labels:
- Source_1: contagion mobile3
- The contagion mobile website is actively open for sharing the malware dataset. Anyone can upload the mobile malware samples to Contagio mobile mini-dump through dropbox. And people can download any malware samples. Currently, contagion website contains malware samples with family labels from 2011 till now.
Source_2: Android malware samples4
- The repository contains live Android malware applications. Anyone can upload and share the Android malware samples in this repository. At the time when this paper is written, this site contains about 144 Android malicious samples within 26 families.
Source_3: Android Malware Dataset5
If an instance of malware appears in two or three sources, then we aggregate these malware samples together and remove the duplicates. The final malware dataset will be the union of the three malware sources as shown in Eq.(1).
Source_1 ∪ Source_2 ∪ Source_3 (1)
# C. METRICS FOR MALWARE IMPACT
The next challenge is on how to define metrics to evaluate the Android malware impact. Theoretically, there are many metrics available that we can employ to scale the malware impact, for instances, the economic loss or the number of compromised devices resulted by the Android malicious samples. But in reality, it is difficult to collect all the precise metrics values due to various reasons, e.g., it is infeasible for individuals to access the accurate value of global economic loss. Thus, as a proof-of-concept, we define two metrics to evaluate the Android malware impact in this paper:
- Impact Metrics_1: The size of affected Android end devices that the malware family has resulted in, also named SOD for short.
- Impact Metrics_2: The size of countries the candidate malware family has infected, also called SOC for short.
Having defined the Android malware impact metrics, we should set the impact metrics threshold value to segregate low and high impact Android malicious samples. In this work, all the malicious samples within the candidate Android malware family are labeled as high impact malicious samples once one of the two setting conditions is met. Otherwise the malware samples within this Android malware family are then categorized to the low impact samples.
- Condition 1: SOD≥ 1e5, the specific malware family has affected over 1e5 end devices.
- Condition 2: SOC≥ 10, the specific malware family has infected more than 10 countries.
# D. SETUP THE GROUND TRUTH
To setup the ground truth, the best and most reliable way is the manual annotation at individual malware sample level. However, this is difficult, infeasible and resources consuming for us to setup the impact ground truth for many malicious samples. In addition, the following impact prediction model
VOLUME 7, 2019 66307
# J. Qiu et al.: Predicting the Impact of Android Malicious Samples via Machine Learning
is trained without considering the family-boundary of the data. As a proof-of-concept, the ground truth (low impact or high impact) of Android malware samples are annotated on Android malware family-grained. The malicious samples within the high impact families are all annotated as high impact (denoted as High_Mal), while Android malicious samples within other Android malware families will be labeled with low impact ground truth (denoted as Low_Mal).
The baseline Android malware families listi (denoted as Fam_list) can be accessed from this website For each malware family f, we retrieve the values of the defined two impact metrics SOD and SOC from open-source information from various sources. In this work, we collect the related information from various sources, e.g., cyber-security news, white papers, or other related reports published by security vendors, or security-labs (for example, CheckPoint, Symantec, Kaspersky and McAfee).
Let’s explain the ground truth annotation process through a case study. According to a published research report of CheckPoint in 2016, the Android malware family called Copycat has affected more than 14 million mobile devices, rooted about 8 million infected devices, earned about $1 million in false advertisement income for the hackers behind the malware campaign Therefore, all the malware samples within Copycat are annotated with high impact ground truth.
# E. CONSTRUCT THE ANDROID MALWARE IMPACT DATASET
With the available Android malware data and the corresponding impact ground truth, we construct the final Android malware dataset with impact ground truth, called the Mal_Impact Dataset (D). The information about the collected high impact malware samples (High_Mal) is listed in Table 2, and the details of Android malicious samples (Low_Mal) with low impact ground truth can be found in Table 3.
# F. REVERSE ENGINEERING, FEATURE EXTRACTION AND EMBEDDING
After the Mal_Impact Dataset D is constructed, the robust and informative semantic feature set F are decoded to capture the patterns for high impact malware data (High_Mal) and
6 https://forensics.spreitzenbarth.de/android-malware/
7 https://www.checkpoint.com/downloads/resources/copycat-research-report.pdf
# J. Qiu et al.: Predicting the Impact of Android Malicious Samples via Machine Learning
low impact malware data (Low_Mal) in order to accurately separate them. In this paper, we perform reverse engineering of malware samples to parse the features. Generally, the semantic features are parsed from the disassembled binary classes.dex codes and the AndroidManifest.xml files. Each Android application package must contain the AndroidManifest.xml file. This AndroidManifest.xml file contains the essential information of the application, such as the components, the requested permissions, hardwares and filtered intents of the application. We will extract these information to characterize the impact of malware samples. In the following experiment setup, such information are parsed as features to represent each Android malware sample.
Android application packages are usually implemented using Java programming language and then compiled into classes.dex bytecodes for its execution in the Dalvik virtual machine. The classes.dex bytecode contains the comprehensive semantic knowledge about the critical API calls and data access within an application. Besides, the classes.dex bytecode can be efficiently disassembled and parsed.
In order to feed the training malware samples to the machine learning models (denoted as M), we encode the string features of each malware sample as a numerical vector. After the string features for the training malware samples have been extracted, then we map all these features to a joint feature vector space. In this feature vector space, each malware x is embedded into vector representations. We employ the one-hot-encoding strategy to represent each malicious sample as a vector. For each feature fi, if it is presented in x, then the i-th dimension feature value is set to 1, otherwise the corresponding dimension feature value is 0. Iteratively, we map each Android malware into the joint feature vector space. In this space, the malware sharing similar impact characteristics (low impact or high impact) will lie close to each other, but low and high impact malicious samples are expected to be separated with long distances. In addition, due to the large number of API calls, permissions and other features, the one-hot-encoding embedding method will generate extremely high dimensional vector. In order to reduce the storage memory and improve the computation speed, the produced feature matrices of malware samples are stored in the Compressed Sparse Column (CSC) format.
# G. IMPACT MODEL TRAIN AND PREDICTION
This phase is to learn the Android malware impact predict model M. The collected Android malware impact dataset Mal_Impact Dataset (D) is class-imbalanced, however, the imbalanced rate is not too high, less than 5. Thus we expect the traditional machine learning classifiers can work well in this scenario. In this work, we employ the classical Linear Support Vector Machine (SVM)  and Deep Neural Network (DNN)  to train the malware impact prediction models.
The Linear Support Vector Machine has been used in many cyber security related classification tasks. In addition, it is an inherent interpretable classifier which is suitable for feature explanation. We can easily obtain the core features which are helpful for us to figure out the core features in predicting the Android malware impact. The Deep Neural Network has been used to achieve many great successes in various applications, e.g., image recognition, machine translation or cyber security related areas , , , thus we design a specific Deep Neural Network to predict the impact of Android malware samples. As a nonlinear model, Deep Neural Network complements the Linear SVM to provide a comprehensive empirical evaluation.
According to previous academic papers and engineering applications, Linear SVM model is suitable for the small dataset classification scenarios, while DNNs can learn the complex and accurate patterns from large-scale dataset. In our work, we construct an initial and relatively small Android malicious samples impact dataset with impact ground truth. Thus, SVM is expected to perform better than DNN. However, if we can collect more malicious samples together with impact ground truth, then DNN will achieve the best performance in Android malicious samples’ impact prediction task.
The SVM aims to learn an optimal hyperplane which separates the high impact and low impact malware with maximal margin as presented in Fig. 3. To determine the optimal hyperplane, the following objective function Eq.(2) should be minimized .
min 2 1||w||2 s.t., y(wT xi + b) ≥ 1, i = 1, . . . , ni (2)
VOLUME 7, 2019 66309
# J. Qiu et al.: Predicting the Impact of Android Malicious Samples via Machine Learning
The schematic depiction of the SVM malware impact prediction model.
Once the SVM based impact prediction model M has been trained, it will be used to predict the testing malware into low or high impact by computing their distances to the separating hyperplane as shown in Eq.(3).
The architecture of the Deep Neural Network based malware impact prediction model.
The architecture information of the deep neural network designed in our work.
&lt; w, φ(xi + b) ≥ +1 &gt;, for xi is high impact
&lt; w, φ(xi + b) ≤ −1 &gt;, for xi is low impact (3)
The learned weights w can also be used to evaluate the importance of features to the construction of the classifier. In this work, we will use the learned feature weights to measure the contributions of features to the Android malware impact prediction model.
Deep Neural Networks have become an increasingly prevalent technique for malware analysis related applications. Their power of learning complex patterns and behaviors make Deep Neural Networks an appropriate technique for malware detection or classification. In this paper, we also create a Deep Neural Network structure to conduct the malware impact prediction task. To determine the structure and hyperparameters of Deep Neural Network, we have tried several combinations of the layer number and the related neurons number. The activation functions are selected from sigmoid, ReLU and tanh. The optimizer is selected from SGD, Adadelta, RMSprop and Adamax. We have also tried several loss functions, e.g., Mean_Squared_Error, Mean_Absolute_Error and Squared_Hinge. Based on the malware impact performance, we finally determined the structure of the network as presented in Fig. 4. The details of our designed Deep Neural Network can be found in Table 5.
For our designed Deep Neural Network, suppose that the (l − 1)-th layer has m neurons, then the output of the l-th layer’s j-th neuron can be formulated as the following equation :
Here σ is the activation function, ak1 is the k-th input feature xk for l = 2. The matrix formulation of Eq.(4) is:
al = σ (zl ) = σ (W l al−1 + b)l (5)
Then the final loss function can be represented as Eq.(6).
J (W , b, x, y) = 1/2 ||σ (W L aL−1 + bL ) − y||2 (6)
During the learning of W and b, we can compute their gradient with respect to J, and then apply the Back Propagation  optimization algorithm to train the network.
Overfitting is a common problem of Deep Neural Networks . Once a Deep Neural Network is overfitted with the specific malware impact training set, the derived network becomes less useful. To address the overfitting problem, the dropout regularization strategy  is used in our designed Deep Neural Network impact prediction model. With a fixed probability, the Dropout strategy randomly removes a number of incoming and outgoing connections of some neurons. Using the Dropout strategy makes the network relatively independent on a particular set of neurons and the associated weights as well as the biases . In this paper, the dropout rate of the deep neural network is 0.
# IV. EXPERIMENTAL ANALYSIS
To validate the effectiveness of our approach, this section presents an empirical validation of our proposed method.
66310
VOLUME 7, 2019
# J. Qiu et al.: Predicting the Impact of Android Malicious Samples via Machine Learning
To fully evaluate the effectiveness of our proposed solution, we will address the 3 research questions:
- Research Question 1: How effective is it to represent both low and high impact Android malicious samples using AndroidManifest.xml based information (for example, requested permissions, application components or hardware components)?
- Research Question 2: How good is the performance if we represent the low and high impact Android malicious samples exploiting the features decoded from the disassembled binary classes.dex codes (for example, suspicious API calls, critical API calls)?
- Research Question 3: How can we make impact prediction for the newly identified Android malicious samples in the wild?
# A. EXPERIMENTAL SETUPS
The following experiments were implemented on a workstation equipped using two E5-2690 v3 2GHz CPUs, in total of 48 logical CPU cores. The workstation offers 3 TB storage and 64 GB memory which meets the required experiment conditions.
In the reverse engineering part, we use the open sourced tool Androguard . Androguard is a tool developed using python language to reverse engineer Android application packages, e.g., parse AndroidManifest.xml files or disassemble classes.dex bytecodes. Using Androguard we can decode the semantic features to represent Android malicious samples.
During the impact prediction stage, we employ the open-source python Machine Learning package scikit-learn  to perform the training and predicting task of SVM based impact model. We employ the grid search strategy to search the optimal parameters C and gamma for the impact prediction model. 50% of the constructed Mal_Impact Dataset is split as training dataset while the other 50% serves as the test data.
To implement the Deep Neural Network based malware impact prediction model, we use the Tensorflow8 and Keras9 packages to perform the malware impact prediction task. When training the Deep Neural Network, 20% of the training dataset is divided as the validation dataset, then we track the accuracy trends of both the training and validation data. Meanwhile we keep checking whether the model training is finished successfully to prevent overfitting. Once the accuracy growing trend of training and validation data are not consistent, then the training process will be immediately stopped, and network weight parameters are then revised to retrain again to prevent the overfitting issue.
# B. EVALUATION METRICS
The proposed Android malware impact prediction research problem is a class-imbalance problem due to the fact that the size of low impact malicious samples (Low_Mal) is significantly larger than that of high impact malicious samples (High_Mal). Thus to comprehensively validate the effectiveness of our proposed solution, in this work, we employ the next 7 performance metrics:
- TP: the size of low impact Android malicious samples being correctly predicted as low impact malware.
- TN: the size of high impact Android malicious data being correctly predicted as high impact malware.
- FP: the size of low impact Android malicious samples being incorrectly predicted as high impact malware.
- FN: the size of high impact Android malicious data being incorrectly predicted as low impact malware.
- Precision: as shown by Equation 7, the size of correctly identified high impact malware over the size of correctly identified high impact malicious samples and incorrectly identified high impact malicious samples.
P = TP/(TP + FP) (7)
- Recall: as defined in Equation 8, the size of correctly identified high impact malicious samples divided by the size of correctly identified high impact malicious samples and incorrectly identified low impact malicious samples.
R = TP/(TP + FN) (8)
- F1-score: F1-score is a combination of TN, TP, FN and FP. It can reflect the prediction effectiveness of the classifiers in a more comprehensive way. Equation 9 provides the formula for the computation of F1-score.
F1 = 2 P + RP × R (9)
# C. REPRESENT THE LOW AND HIGH IMPACT MALICIOUS SAMPLES USING ANDROIDMANIFEST.XML BASED FEATURES
In this part, we address our first research question, we perform the impact prediction task based on information from AndroidManifest.xml files. Both low impact malware (Low_Mal) samples and high impact samples (High_Mal) are characterized using AndroidManifest.xml based features.
To investigate the discriminative ability of AndroidManifest.xml based features, we visualize the malware data using t-SNE (t-Distributed Stochastic Neighbor Embedding) algorithm . t-SNE is a popular algorithm for reducing dimensions that is suited for high dimensional data visualization.
8 https://www.tensorflow.org/
9 https://keras.io/
# J. Qiu et al.: Predicting the Impact of Android Malicious Samples via Machine Learning
The size of the malware, especially the high impact malware is too few for training robust Deep Neural Networks. In order to measure the contributions of different individual features in separating low impact and high impact malware, based on the SVM malware impact prediction model (each weight is assigned to a certain feature), we list the most top 10 features in the descending order according to the absolute values of the weight scores (denoted as ||w||) in Table 8. From Table 8, among the top 10 features, 5 features are permission involved and 3 features are intent filters involved. We conclude that the intent filters and requested permissions involved features have better discriminative power in separating low impact and high impact malicious samples. In addition, the common sensitive and suspicious features all appear in the top 10 feature list, e.g., the SMS related permissions, reboot related permissions or camera related permissions.
# D. REPRESENT THE LOW AND HIGH IMPACT MALICIOUS SAMPLES EMPLOYING THE INFORMATION PARSED FROM DISASSEMBLED CLASSES.DEX CODE
In this part, to answer the third research question, we represent the Android malicious samples using features decoded from the disassembled classes.dex codes, and then we vectorize the malicious samples for the following impact prediction task. Fig. 7 shows the visualization result of the training malware dataset, and Fig. 8 is the visualization result for the
66312 VOLUME 7, 2019
# J. Qiu et al.: Predicting the Impact of Android Malicious Samples via Machine Learning
Testing malware samples. There is a clear boundary between low impact and high impact malicious samples. Therefore, the disassembled classes.dex involved features can also discriminate the low and high impact Android malicious samples with satisfactory performance.
We represent all the malware samples D with features from disassembled classes.dex code, then we perform the malware impact prediction task. Table 9 and Table 10 show the malware impact prediction results of SVM and Deep Neural Network. Compared with the performance using Android-Manifest.xml based features, we find that the prediction performance is slightly worse but also satisfactory. Besides, the performance of SVM is better than that of Deep Neural Network due to the data size limitation.
# E. PREDICT THE IMPACT OF NEWLY IDENTIFIED ANDROID MALWARE IN THE WILD
As we know, Android malware evolve over time due to many factors, e.g., the employment of obfuscation or encryption techniques. Meanwhile, the properties of both low and high impact malware will also change over time. Thus the impact prediction accuracy might significantly decrease if we ignore such evolution of newly Android malware in the wild. Therefore it is essential to take into account such evolution of impact characteristics while validating the effectiveness of our proposed solution. In this section, our goal is to address the third research question: Is it possible to accurately and automatically make the impact prediction for those newly identified malware in the wild?
In order to investigate this research question, we simulate the malware evolution scenario by training the impact prediction models with ‘older’ malware samples (the low impact and high impact malicious samples were all detected between 2011 to 2015), while testing the model with ‘newer’ samples (these malware were detected in 2016 and 2017). In the experiments, the number of ‘older’ training low impact and high impact malicious samples is 15912 and 3409, respectively, and the ‘newer’ testing dataset includes 4537 low impact malicious samples and 928 high impact malicious samples.
In this work, we define a new evaluation metric prediction power to evaluate the contributions of different semantic feature subsets (e.g., requested permissions f_rp, filtered intents f_fi or suspicious API calls f_sa...) in malware impact prediction. Since the collected Android malware impact dataset is class-imbalanced, to make a comprehensive evaluation, we selected F1-score rather than accuracy or precision as the evaluation metric of prediction power. The higher prediction F1-score is, the corresponding feature subset is considered to have greater prediction power. Different feature subsets are individually employed to represent the malware samples for the following impact prediction. The prediction power of each feature set is shown in Fig.
Firstly, among all the semantic feature set extracted from AndroidManifest.xml files, application components set f_ac, requested permissions set f_rp and filtered intents set f_fi have the optimal prediction power for low impact malware samples (Low_Mal) as well as high impact malware samples (High_Mal), while hardware components feature set f_hc has the worst prediction power, particularly for those high impact malicious samples (High_Mal). In addition, for feature sets extracted from disassembled classes.dex codes, the prediction power of suspicious API calls feature set f_sa and Used permissions feature set f_up are superior to that of network addresses set f_na and critical API calls set f_ca. In conclusion, in the task of Android malicious samples impact prediction, features decoded from Android-Manifest.xml files have more strong prediction power than features parsed from disassembled classes.dex codes.
Shows the impact prediction performance of SVM and Deep Neural Network using features from
VOLUME 7, 2019
# J. Qiu et al.: Predicting the Impact of Android Malicious Samples via Machine Learning
The comparison results of every feature type’s prediction power.
The malware impact prediction results of SVM using features from both disassembled binary classes.dex codes and AndroidManifest.xml files to represent malware samples.
The malware impact prediction results of deep neural network using features from both disassembled binary classes.dex codes and AndroidManifest.xml files to represent malware samples.
Both disassembled binary classes.dex codes and AndroidManifest.xml. Aggregating more features should produce better prediction performance. SVM also performs better than Deep Neural Network in the impact prediction of those newly identified Android malware. However, employing more features also implies it cost more expensive resources (e.g., time consumption, memory consumption) in reverse engineering.
In reality, the security practitioner should balance the tradeoff between accuracy and efficiency.
# V. CONCLUSIONS AND FUTURE DIRECTIONS
Android malware cause great security and privacy damage to our society. Despite huge research efforts, with the tremendous growth in Android malware applications, detecting the malware or classifying malware into specific families has no longer sufficient for security risk management. In this work, we raise a novel research problem: Is it possible to accurately and automatically make the impact prediction for the newly identified Android malicious samples? We attempt to design a light-weight solution to address this research question. Firstly, we construct a new Android malware dataset with low impact or high impact ground truth. Then, we perform feature engineering to parse semantic features to represent the malware samples. Thirdly, we build up the SVM and Deep Neural Network models to predict the impact of Android malicious samples. In the end, the empirical experiments validate the effectiveness of our proposed solution in the Android malware impact prediction.
In the future, our research work will focus on the following directions: On the one hand, we will investigate more impact related metrics, for example, the economic loss caused by the malware, to directly reflect the impact of Android malware. Besides, we may collaborate with security corporations or labs to obtain more accurate and trusted metrics values. On the other hand, we will collect more Android malware samples from other sources to update the created dataset in this paper. What’s more, more advanced and informative features, e.g., graph based features (FCG, CFG), tree based features (abstract syntax tree), will be introduced to accurately capture the impact characteristics of Android malware.
# J. Qiu et al.: Predicting the Impact of Android Malicious Samples via Machine Learning
# J. Qiu et al.: Predicting the Impact of Android Malicious Samples via Machine Learning
# Authors
# JUNYANG QIU
is currently pursuing the Ph.D. degree with the School of Information Technology, Deakin University. His research interests include cyber security and machine learning.
# YONGHANG TAI
received the M.Sc. degree in optic engineering from Yunnan Normal University, in 2012, and the Ph.D. degree in computer science from Deakin University, Australia, in 2019. His current research interests include cybersecurity and applied machine learning. In addition, he focuses on developing intelligent defense systems against sophisticated cyber attacks.
# JUN ZHANG
received the Ph.D. degree in computer science from the University of Wollongong, Australia, in 2011. He is currently an Associate Professor with the School of Software and Electrical Engineering, and the Deputy Director of the Swinburne Cybersecurity Lab, Swinburne University of Technology, Australia. His research interests include cybersecurity and applied machine learning. He has published more than 100 research papers in refereed international journals and conferences, such as the IEEE COMMUNICATIONS SURVEYS AND TUTORIALS, the IEEE/ACM TRANSACTIONS ON NETWORKING, the IEEE TRANSACTIONS ON IMAGE PROCESSING, the IEEE TRANSACTIONS ON PARALLEL AND DISTRIBUTED SYSTEMS, the IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY, the ACM Conference on Computer and Communications Security, and the ACM Asia Conference on Computer and Communications Security. His publications have been widely cited in the area of cybersecurity. He is an IEEE Senior Member. He has been internationally recognized as an Active Researcher in cybersecurity, evidenced by his chairing of eight international conferences, from 2013, and presenting of invited keynote addresses in two conferences, and an Invited Lecturer in the IEEE SMC Victorian Chapter.
# WEI LUO
received the Ph.D. degree in computer science from Simon Fraser University, Canada. He is currently a Senior Lecturer with the School of Information Technology, Deakin University. He has published more than 40 research papers in refereed international journals and conferences. His research interests include data mining and machine learning.
# LEI PAN
received the Ph.D. degree in computer forensics from Deakin University, Australia, in 2008, where he is currently a Senior Lecturer with the School of Information Technology. His research interest includes cyber security and privacy. He has published more than 30 research papers in refereed international journals and conferences, such as the IEEE Security & Privacy, Journal of Multimedia, and Digital Investigation. He is a member of the IEEE.
# YANG XIANG
received the Ph.D. degree in computer science from Deakin University, Australia. He is currently the Dean of the Digital Research and Innovation Capability Platform, Swinburne University of Technology, Australia. His research interest includes cyber security, which covers network and system security, data analytics, distributed systems, and networking. In the past 20 years, he has been leading the team developing active defense systems against large-scale distributed network attacks. His translational research has made significant impact on the real-world applications, such as AI-driven cyber security applications, malware applications, cloud and the IoT security applications, and blockchain applications. His research was funded by the Australian Research Council (ARC) and industry partners. He has published more than 200 research papers in many international journals and conferences, such as the IEEE TRANSACTIONS ON COMPUTERS, the IEEE TRANSACTIONS ON PARALLEL AND DISTRIBUTED SYSTEMS, the IEEE TRANSACTIONS ON INFORMATION SECURITY AND FORENSICS, and the IEEE TRANSACTIONS ON DEPENDABLE AND SECURE COMPUTING. He has published three books: Honeypot Frameworks and Their Applications: A New Framework (Springer), Software Similarity and Classification (Springer), and Dynamic and Advanced Data Mining for Progressing Technological Development (IGI-Global). He is a Senior Member of the IEEE. He is the foundation Editor-in-Chief of the SpringerBriefs on Cyber Security Systems and Networks. He is the Co-Founder and the Steering Committee Chair of the NSS, ICA3PP, CSS, SocialSec conference series. He served as the Associate Editor for the IEEE TRANSACTIONS ON COMPUTERS, the IEEE TRANSACTIONS ON PARALLEL AND DISTRIBUTED SYSTEMS, and Security and Communication Networks (Wiley), and the Editor of the Journal of Network and Computer Applications. He is the Coordinator for the IEEE Computer Society Technical Committee on Distributed Processing (TCDP).
66316 VOLUME 7, 2019